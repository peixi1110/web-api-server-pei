{"version":3,"file":"index-CxYtHm_S.js","sources":["../../src/pages/ChangePsw/index.js"],"sourcesContent":["import { Form, Input, Button, Breadcrumb, Card, message } from 'antd'\r\nimport { useNavigate, Link } from 'react-router-dom'\r\nimport { updatePwdAPI } from '@/apis/userInfo';\r\nimport { useSelector } from 'react-redux';\r\nimport { clearUserInfo } from '@/store/modules/user';\r\n\r\nconst ChangePsw = () => {\r\n    const [form] = Form.useForm()\r\n    const navigate = useNavigate()\r\n\r\n    const userInfo = useSelector(state => state.user.userInfo.data)\r\n    const userId = userInfo?.id\r\n\r\n    const handleFinish = async (values) => {\r\n        const pwdData = {\r\n            id: userId, \r\n            newPwd: values.newPwd,\r\n            oldPwd: values.oldPwd\r\n        }\r\n        \r\n        const res = await updatePwdAPI(pwdData)\r\n\r\n        if (res.data.status === 1){\r\n            message.error('Wrong old Password!')\r\n        \r\n            // return Promise.reject(new Error('Wrong old password'))\r\n        } else {\r\n            message.success('Your password has been changed. Please log in again.')\r\n            clearUserInfo()\r\n        }\r\n    }\r\n\r\n    const pwdFormat = /^[\\S]{4,16}$/\r\n    const validateNewPassword = (_, value) => {\r\n        if (value && !pwdFormat.test(value)) {\r\n            return Promise.reject(new Error('The password format you entered is not allowed. Please enter 4 to 16 non-blank characters.'))\r\n        }\r\n        if (value && value === form.getFieldValue('oldPwd')) {\r\n            return Promise.reject(new Error('New password cannot same with old password!'))\r\n        }\r\n        return Promise.resolve()\r\n    }\r\n\r\n    const validateConfirmassword = (_, value) => {\r\n        if (!value || form.getFieldValue('newPwd') === value) {\r\n            return Promise.resolve();\r\n        }\r\n        return Promise.reject(new Error('The two passwords do not match!'));\r\n    }\r\n\r\n    const onChange = () => {\r\n        form.validateFields(['confirmPsw'])\r\n    }\r\n\r\n    return (\r\n        <Card\r\n            title={\r\n                <Breadcrumb items={[\r\n                    { title: <Link to={'/'}>Home</Link> },\r\n                    { title: 'Change Password' },\r\n                ]} />\r\n            }\r\n            style={{ marginBottom: 20 }}\r\n        >\r\n            <Form\r\n                style={{ marginTop: 10, marginLeft: 30, width: 350 }}\r\n                form={form}\r\n                layout=\"vertical\"\r\n                onFinish={handleFinish}\r\n                validateTrigger=\"onBlur\"\r\n            >\r\n                <Form.Item\r\n                    label=\"Old password: \"\r\n                    name=\"oldPwd\"\r\n                    rules={[{ required: true, message: 'Please input old password!' }]}\r\n                >\r\n                    <Input placeholder=\"Please enter your old password\"/>\r\n                </Form.Item>\r\n                <Form.Item\r\n                    label=\"New password: \"\r\n                    name=\"newPwd\"\r\n                    rules={[\r\n                        { required: true, message: 'Please input new password!' },\r\n                        { validator: validateNewPassword }\r\n                    ]}\r\n                    hasFeedback\r\n                >\r\n                    <Input placeholder=\"Please enter a new password of 4-16 digits\"/>\r\n                </Form.Item>\r\n                <Form.Item\r\n                    label=\"Confirm password: \"\r\n                    name=\"confirmPsw\"\r\n                    dependencies={['newPwd']}\r\n                    rules={[\r\n                        { required: true, message: 'Please confirm your password!' },\r\n                        { validator: validateConfirmassword }\r\n                    ]}\r\n                    hasFeedback\r\n                >\r\n                    <Input \r\n                    onChange={onChange} \r\n                    placeholder=\"Please confirm your new password\"\r\n                    />\r\n                </Form.Item>\r\n                <Form.Item>\r\n                    <Button type=\"primary\" htmlType=\"submit\">\r\n                        Save\r\n                    </Button>\r\n                    <Button style={{ marginLeft: 8 }} onClick={() => navigate('/')}>\r\n                        Cancel\r\n                    </Button>\r\n                </Form.Item>\r\n            </Form>\r\n        </Card>\r\n    );\r\n}\r\n\r\nexport default ChangePsw;"],"names":["ChangePsw","form","Form","navigate","useNavigate","userInfo","useSelector","state","userId","handleFinish","values","pwdData","updatePwdAPI","message","clearUserInfo","pwdFormat","validateNewPassword","_","value","validateConfirmassword","onChange","jsx","Card","Breadcrumb","Link","jsxs","Input","Button"],"mappings":"iKAMA,MAAMA,EAAY,IAAM,CACpB,KAAM,CAACC,CAAI,EAAIC,EAAK,QAAQ,EACtBC,EAAWC,IAEXC,EAAWC,EAAYC,GAASA,EAAM,KAAK,SAAS,IAAI,EACxDC,EAASH,GAAA,YAAAA,EAAU,GAEnBI,EAAe,MAAOC,GAAW,CACnC,MAAMC,EAAU,CACZ,GAAIH,EACJ,OAAQE,EAAO,OACf,OAAQA,EAAO,MAAA,GAGP,MAAME,EAAaD,CAAO,GAE9B,KAAK,SAAW,EACpBE,EAAQ,MAAM,qBAAqB,GAInCA,EAAQ,QAAQ,sDAAsD,EACxDC,IAClB,EAGEC,EAAY,eACZC,EAAsB,CAACC,EAAGC,IACxBA,GAAS,CAACH,EAAU,KAAKG,CAAK,EACvB,QAAQ,OAAO,IAAI,MAAM,4FAA4F,CAAC,EAE7HA,GAASA,IAAUjB,EAAK,cAAc,QAAQ,EACvC,QAAQ,OAAO,IAAI,MAAM,6CAA6C,CAAC,EAE3E,QAAQ,UAGbkB,EAAyB,CAACF,EAAGC,IAC3B,CAACA,GAASjB,EAAK,cAAc,QAAQ,IAAMiB,EACpC,QAAQ,UAEZ,QAAQ,OAAO,IAAI,MAAM,iCAAiC,CAAC,EAGhEE,EAAW,IAAM,CACdnB,EAAA,eAAe,CAAC,YAAY,CAAC,CAAA,EAIlC,OAAAoB,EAAA,IAACC,EAAA,CACG,MACKD,EAAA,IAAAE,EAAA,CAAW,MAAO,CACf,CAAE,MAAOF,EAAA,IAACG,GAAK,GAAI,IAAK,gBAAI,CAAQ,EACpC,CAAE,MAAO,iBAAkB,CAAA,EAC5B,EAEP,MAAO,CAAE,aAAc,EAAG,EAE1B,SAAAC,EAAA,KAACvB,EAAA,CACG,MAAO,CAAE,UAAW,GAAI,WAAY,GAAI,MAAO,GAAI,EACnD,KAAAD,EACA,OAAO,WACP,SAAUQ,EACV,gBAAgB,SAEhB,SAAA,CAAAY,EAAA,IAACnB,EAAK,KAAL,CACG,MAAM,iBACN,KAAK,SACL,MAAO,CAAC,CAAE,SAAU,GAAM,QAAS,6BAA8B,EAEjE,SAAAmB,EAAAA,IAACK,EAAM,CAAA,YAAY,gCAAgC,CAAA,CAAA,CACvD,EACAL,EAAA,IAACnB,EAAK,KAAL,CACG,MAAM,iBACN,KAAK,SACL,MAAO,CACH,CAAE,SAAU,GAAM,QAAS,4BAA6B,EACxD,CAAE,UAAWc,CAAoB,CACrC,EACA,YAAW,GAEX,SAAAK,EAAAA,IAACK,EAAM,CAAA,YAAY,4CAA4C,CAAA,CAAA,CACnE,EACAL,EAAA,IAACnB,EAAK,KAAL,CACG,MAAM,qBACN,KAAK,aACL,aAAc,CAAC,QAAQ,EACvB,MAAO,CACH,CAAE,SAAU,GAAM,QAAS,+BAAgC,EAC3D,CAAE,UAAWiB,CAAuB,CACxC,EACA,YAAW,GAEX,SAAAE,EAAA,IAACK,EAAA,CACD,SAAAN,EACA,YAAY,kCAAA,CACZ,CAAA,CACJ,EACAK,EAAAA,KAACvB,EAAK,KAAL,CACG,SAAA,CAAAmB,MAACM,EAAO,CAAA,KAAK,UAAU,SAAS,SAAS,SAEzC,OAAA,EACCN,EAAAA,IAAAM,EAAA,CAAO,MAAO,CAAE,WAAY,CAAA,EAAK,QAAS,IAAMxB,EAAS,GAAG,EAAG,SAEhE,QAAA,CAAA,CAAA,EACJ,CAAA,CAAA,CACJ,CAAA,CAAA,CAGZ"}